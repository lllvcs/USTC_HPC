
<!DOCTYPE html>

<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>LSF作业调度系统 &#8212; 中国科大超级计算中心用户使用文档 2021-03 文档</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="LaTeX pdf版" href="../latex.html" />
    <link rel="prev" title="简介" href="../slurm/slurm.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=#4000FF data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#lsf/lsf" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="中国科大超级计算中心用户使用文档 2021-03 文档"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/logo.png" height="26"
                   alt="中国科大超级计算中心用户使用文档 2021-03 文档 logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">中国科大超算中心用户使用手册</span>
          <span class="md-header-nav__topic"> LSF作业调度系统 </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://git.ustc.edu.cn/scc/user-doc" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    手册源码git
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">中国科大超级计算中心用户使用文档 2021-03 文档</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="中国科大超级计算中心用户使用文档 2021-03 文档" class="md-nav__button md-logo">
      
        <img src="../_static/logo.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="中国科大超级计算中心用户使用文档 2021-03 文档">中国科大超算中心用户使用手册</a>
  </label>
    <div class="md-nav__source">
      <a href="https://git.ustc.edu.cn/scc/user-doc" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    手册源码git
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../preface.html" class="md-nav__link">前言</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../introduction/index.html" class="md-nav__link">现有超级计算系统</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../login-ftp/login-ftp.html" class="md-nav__link">用户登录与文件传输</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../module-environment/module-environment.html" class="md-nav__link">设置编译及运行环境</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../serial-compiling/serial-compiling.html" class="md-nav__link">串行及OpenMP程序编译及运行</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../compiler/index.html" class="md-nav__link">Intel、PGI及GNU C/C++ Fortran编译器介绍</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../gpu-computing/gpu-computing.html" class="md-nav__link">GPU异构计算和CUDA程序简介</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mpi-application/mpi-application.html" class="md-nav__link">MPI并行程序编译及运行</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../debug/debug.html" class="md-nav__link">程序调试</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intel-mkl/intel-mkl.html" class="md-nav__link">Intel MKL数值函数库</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../compile-install/compile-install.html" class="md-nav__link">应用程序的编译与安装</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../slurm/index.html" class="md-nav__link">Slurm作业调度系统</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> LSF作业调度系统 </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">LSF作业调度系统</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lsf-lsf--page-root" class="md-nav__link">LSF作业调度系统</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">作业运行的条件</a>
        </li>
        <li class="md-nav__item"><a href="#bqueues" class="md-nav__link">查看队列情况：bqueues</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#bqueues-l" class="md-nav__link">查看队列详细情况：bqueues -l</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#lsload" class="md-nav__link">查看各节点的运行情况：lsload</a>
        </li>
        <li class="md-nav__item"><a href="#bhosts" class="md-nav__link">查看各节点的空闲情况：bhosts</a>
        </li>
        <li class="md-nav__item"><a href="#busers" class="md-nav__link">查看用户信息：busers</a>
        </li>
        <li class="md-nav__item"><a href="#bsub" class="md-nav__link">提交作业：bsub</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#bsub-q" class="md-nav__link">提交到特定队列：bsub -q</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-n-1" class="md-nav__link">提交串行作业：bsub -n 1</a>
        </li>
        <li class="md-nav__item"><a href="#cpu-bsub-n" class="md-nav__link">指明所需要的CPU核数：bsub -n</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-m-host-name" class="md-nav__link">提交到特定节点：bsub -m “host_name”</a>
        </li>
        <li class="md-nav__item"><a href="#mpi-bsub-n-num-mpijob" class="md-nav__link">提交MPI作业：bsub -n NUM mpijob</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-r" class="md-nav__link">指明需要某种资源作业提交：bsub -R</a>
        </li>
        <li class="md-nav__item"><a href="#openmp-bsub-r-span-hosts-1-omp-num-threads" class="md-nav__link">提交OpenMP等共享内存作业：bsub -R “span[hosts=1]” OMP_NUM_THREADS=</a>
        </li>
        <li class="md-nav__item"><a href="#mpiopenmp" class="md-nav__link">MPI和OpenMP共享内存混合并行作业</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-p-project-name" class="md-nav__link">给作业起个名字：bsub -P project_name</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-x" class="md-nav__link">运行排他性作业：bsub -x</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-i-o-e" class="md-nav__link">指明输出、输出文件运行：bsub -i -o -e</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-outdir-output-directory" class="md-nav__link">指明输出目录提交：bsub -outdir output_directory</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-i" class="md-nav__link">交互式运行作业：bsub -I</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-w" class="md-nav__link">满足依赖关系运行作业：bsub -w</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-b-time" class="md-nav__link">指定时间运行：bsub -b time</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-w-time" class="md-nav__link">指定运行时长：bsub -W time</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-e-pre-command" class="md-nav__link">在运行前执行特定命令：bsub -E “pre_command”</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-ep-post-command" class="md-nav__link">在运行后执行特定命令：bsub -Ep “post_command”</a>
        </li>
        <li class="md-nav__item"><a href="#id3" class="md-nav__link">LSF作业脚本</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#bkill" class="md-nav__link">终止作业：bkill</a>
        </li>
        <li class="md-nav__item"><a href="#bstop" class="md-nav__link">挂起作业：bstop</a>
        </li>
        <li class="md-nav__item"><a href="#bresume" class="md-nav__link">继续运行被挂起的作业：bresume</a>
        </li>
        <li class="md-nav__item"><a href="#btop" class="md-nav__link">设置作业最先运行：btop</a>
        </li>
        <li class="md-nav__item"><a href="#bbot" class="md-nav__link">设置作业最后运行：bbot</a>
        </li>
        <li class="md-nav__item"><a href="#bmod" class="md-nav__link">修改排队中的作业选项：bmod</a>
        </li>
        <li class="md-nav__item"><a href="#bjobs" class="md-nav__link">查看作业的排队和运行情况：bjobs</a>
        </li>
        <li class="md-nav__item"><a href="#checkjob" class="md-nav__link">查看作业负载：checkjob</a>
        </li>
        <li class="md-nav__item"><a href="#bpeek" class="md-nav__link">查看运行中作业的屏幕正常输出：bpeek</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#id1" class="md-nav__link">作业运行的条件</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bqueues" class="md-nav__link">查看队列情况：bqueues</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#bqueues-l" class="md-nav__link">查看队列详细情况：bqueues -l</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#lsload" class="md-nav__link">查看各节点的运行情况：lsload</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bhosts" class="md-nav__link">查看各节点的空闲情况：bhosts</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#busers" class="md-nav__link">查看用户信息：busers</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub" class="md-nav__link">提交作业：bsub</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#bsub-q" class="md-nav__link">提交到特定队列：bsub -q</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-n-1" class="md-nav__link">提交串行作业：bsub -n 1</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#cpu-bsub-n" class="md-nav__link">指明所需要的CPU核数：bsub -n</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-m-host-name" class="md-nav__link">提交到特定节点：bsub -m “host_name”</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#mpi-bsub-n-num-mpijob" class="md-nav__link">提交MPI作业：bsub -n NUM mpijob</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-r" class="md-nav__link">指明需要某种资源作业提交：bsub -R</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#openmp-bsub-r-span-hosts-1-omp-num-threads" class="md-nav__link">提交OpenMP等共享内存作业：bsub -R “span[hosts=1]” OMP_NUM_THREADS=</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#mpiopenmp" class="md-nav__link">MPI和OpenMP共享内存混合并行作业</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-p-project-name" class="md-nav__link">给作业起个名字：bsub -P project_name</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-x" class="md-nav__link">运行排他性作业：bsub -x</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-i-o-e" class="md-nav__link">指明输出、输出文件运行：bsub -i -o -e</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-outdir-output-directory" class="md-nav__link">指明输出目录提交：bsub -outdir output_directory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-i" class="md-nav__link">交互式运行作业：bsub -I</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-w" class="md-nav__link">满足依赖关系运行作业：bsub -w</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-b-time" class="md-nav__link">指定时间运行：bsub -b time</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-w-time" class="md-nav__link">指定运行时长：bsub -W time</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-e-pre-command" class="md-nav__link">在运行前执行特定命令：bsub -E “pre_command”</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bsub-ep-post-command" class="md-nav__link">在运行后执行特定命令：bsub -Ep “post_command”</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#id3" class="md-nav__link">LSF作业脚本</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bkill" class="md-nav__link">终止作业：bkill</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bstop" class="md-nav__link">挂起作业：bstop</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bresume" class="md-nav__link">继续运行被挂起的作业：bresume</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#btop" class="md-nav__link">设置作业最先运行：btop</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bbot" class="md-nav__link">设置作业最后运行：bbot</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bmod" class="md-nav__link">修改排队中的作业选项：bmod</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bjobs" class="md-nav__link">查看作业的排队和运行情况：bjobs</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#checkjob" class="md-nav__link">查看作业负载：checkjob</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bpeek" class="md-nav__link">查看运行中作业的屏幕正常输出：bpeek</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../latex.html" class="md-nav__link">LaTeX pdf版</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contact.html" class="md-nav__link">联系方式</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lsf-lsf--page-root" class="md-nav__link">LSF作业调度系统</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">作业运行的条件</a>
        </li>
        <li class="md-nav__item"><a href="#bqueues" class="md-nav__link">查看队列情况：bqueues</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#bqueues-l" class="md-nav__link">查看队列详细情况：bqueues -l</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#lsload" class="md-nav__link">查看各节点的运行情况：lsload</a>
        </li>
        <li class="md-nav__item"><a href="#bhosts" class="md-nav__link">查看各节点的空闲情况：bhosts</a>
        </li>
        <li class="md-nav__item"><a href="#busers" class="md-nav__link">查看用户信息：busers</a>
        </li>
        <li class="md-nav__item"><a href="#bsub" class="md-nav__link">提交作业：bsub</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#bsub-q" class="md-nav__link">提交到特定队列：bsub -q</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-n-1" class="md-nav__link">提交串行作业：bsub -n 1</a>
        </li>
        <li class="md-nav__item"><a href="#cpu-bsub-n" class="md-nav__link">指明所需要的CPU核数：bsub -n</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-m-host-name" class="md-nav__link">提交到特定节点：bsub -m “host_name”</a>
        </li>
        <li class="md-nav__item"><a href="#mpi-bsub-n-num-mpijob" class="md-nav__link">提交MPI作业：bsub -n NUM mpijob</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-r" class="md-nav__link">指明需要某种资源作业提交：bsub -R</a>
        </li>
        <li class="md-nav__item"><a href="#openmp-bsub-r-span-hosts-1-omp-num-threads" class="md-nav__link">提交OpenMP等共享内存作业：bsub -R “span[hosts=1]” OMP_NUM_THREADS=</a>
        </li>
        <li class="md-nav__item"><a href="#mpiopenmp" class="md-nav__link">MPI和OpenMP共享内存混合并行作业</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-p-project-name" class="md-nav__link">给作业起个名字：bsub -P project_name</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-x" class="md-nav__link">运行排他性作业：bsub -x</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-i-o-e" class="md-nav__link">指明输出、输出文件运行：bsub -i -o -e</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-outdir-output-directory" class="md-nav__link">指明输出目录提交：bsub -outdir output_directory</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-i" class="md-nav__link">交互式运行作业：bsub -I</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-w" class="md-nav__link">满足依赖关系运行作业：bsub -w</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-b-time" class="md-nav__link">指定时间运行：bsub -b time</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-w-time" class="md-nav__link">指定运行时长：bsub -W time</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-e-pre-command" class="md-nav__link">在运行前执行特定命令：bsub -E “pre_command”</a>
        </li>
        <li class="md-nav__item"><a href="#bsub-ep-post-command" class="md-nav__link">在运行后执行特定命令：bsub -Ep “post_command”</a>
        </li>
        <li class="md-nav__item"><a href="#id3" class="md-nav__link">LSF作业脚本</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#bkill" class="md-nav__link">终止作业：bkill</a>
        </li>
        <li class="md-nav__item"><a href="#bstop" class="md-nav__link">挂起作业：bstop</a>
        </li>
        <li class="md-nav__item"><a href="#bresume" class="md-nav__link">继续运行被挂起的作业：bresume</a>
        </li>
        <li class="md-nav__item"><a href="#btop" class="md-nav__link">设置作业最先运行：btop</a>
        </li>
        <li class="md-nav__item"><a href="#bbot" class="md-nav__link">设置作业最后运行：bbot</a>
        </li>
        <li class="md-nav__item"><a href="#bmod" class="md-nav__link">修改排队中的作业选项：bmod</a>
        </li>
        <li class="md-nav__item"><a href="#bjobs" class="md-nav__link">查看作业的排队和运行情况：bjobs</a>
        </li>
        <li class="md-nav__item"><a href="#checkjob" class="md-nav__link">查看作业负载：checkjob</a>
        </li>
        <li class="md-nav__item"><a href="#bpeek" class="md-nav__link">查看运行中作业的屏幕正常输出：bpeek</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="lsf">
<h1 id="lsf-lsf--page-root">LSF作业调度系统<a class="headerlink" href="#lsf-lsf--page-root" title="此标题的永久链接">¶</a></h1>
<p>曙光TC4600百万亿次超级计算系统利用IBM Spectrum LSF 10.1.0进行资源和作业调度管理，所有需要运行的作业均必须通过作业提交命令<code class="docutils literal notranslate"><span class="pre">bsub</span></code>提交，提交后可利用相关命令查询作业状态等。为了利用<code class="docutils literal notranslate"><span class="pre">bsub</span></code>提交作业，需要在<code class="docutils literal notranslate"><span class="pre">bsub</span></code>中指定各选项和需要执行的程序。注意：</p>
<ul class="simple">
<li><p>不要在登录节点(tc4600)上不通过作业调度管理系统直接运行作业（编译等日常操作除外），以免影响其余用户的正常使用。</p></li>
<li><p>如果不通过作业调度管理系统直接在计算节点上运行将会被监护进程直接杀掉。</p></li>
</ul>
<section id="id1">
<h2 id="id1">作业运行的条件<a class="headerlink" href="#id1" title="此标题的永久链接">¶</a></h2>
<p>作业提交后需要一段时间等待作业调度系统调度运行，一般为先提交的先运行，并且作业运行需要满足多个基本条件：</p>
<ul class="simple">
<li><p>系统有空闲资源，满足程序运行需要。可以利用<code class="docutils literal notranslate"><span class="pre">bhosts</span></code>命令查看，ok状态的才可以接受作业运行。</p></li>
<li><p>用户作业没有超过系统设置的允许用户运行的作业数，可以利用<code class="docutils literal notranslate"><span class="pre">busers</span></code>命令查看。</p></li>
<li><p>用户作业没有超过所使用的作业队列的允许作业核数的限制，可以利用<code class="docutils literal notranslate"><span class="pre">bqueues</span></code>命令查看。</p></li>
<li><p>用户作业没有被挂起等。利用<code class="docutils literal notranslate"><span class="pre">bjobs</span></code>命令查看。</p></li>
<li><p>作业调度管理系统工作正常。</p></li>
</ul>
<p>当系统作业繁忙时，如果提交需要核数很多的作业，也许需要长时间才可以运行甚至根本无法获取到足够资源来运行，请考虑选择合适的并行规模。</p>
<p>作业如不运行，请先请运行<code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-l</span> <span class="pre">JobID</span></code>或<code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-p</span> <span class="pre">JobID</span></code>查看输出信息中PENDING
REASONS部分及提交时设置的参数等，并结合运行上述几个命令查看原因。</p>
<p>如果上述条件都符合，也许作业调度管理系统存在问题，请与超算中心工作人员联系处理。</p>
</section>
<section id="bqueues">
<h2 id="bqueues">查看队列情况：bqueues<a class="headerlink" href="#bqueues" title="此标题的永久链接">¶</a></h2>
<p>用户在使用时，首先需要了解哪些队列可以使用，利用<code class="docutils literal notranslate"><span class="pre">bqueues</span></code>可以查看现有队列信息。</p>
<p>具体队列会根据需要更改，请注意登录系统后的提示，或运行<code class="docutils literal notranslate"><span class="pre">bqueues</span> <span class="pre">-l</span></code>查看。</p>
<p><code class="docutils literal notranslate"><span class="pre">bqueues</span></code></p>
<p>将输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QUEUE_NAME</span> <span class="n">PRIO</span> <span class="n">STATUS</span>       <span class="n">MAX</span>  <span class="n">JL</span><span class="o">/</span><span class="n">U</span>  <span class="n">JL</span><span class="o">/</span><span class="n">P</span> <span class="n">JL</span><span class="o">/</span><span class="n">H</span> <span class="n">NJOBS</span>  <span class="n">PEND</span>   <span class="n">RUN</span>  <span class="n">SUSP</span>
<span class="n">long</span>        <span class="mi">59</span>  <span class="n">Open</span><span class="p">:</span><span class="n">Active</span>  <span class="mi">1200</span> <span class="mi">1200</span>    <span class="o">-</span>    <span class="o">-</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>
<span class="n">normal</span>      <span class="mi">58</span>  <span class="n">Open</span><span class="p">:</span><span class="n">Inact</span>   <span class="mi">1440</span>  <span class="mi">192</span>    <span class="o">-</span>    <span class="o">-</span>   <span class="mi">360</span>     <span class="mi">0</span>   <span class="mi">360</span>     <span class="mi">0</span>
<span class="n">small</span>       <span class="mi">57</span>  <span class="n">Closed</span><span class="p">:</span><span class="n">Active</span> <span class="mi">720</span>  <span class="mi">120</span>    <span class="o">-</span>    <span class="o">-</span>  <span class="mi">1976</span>  <span class="mi">1476</span>   <span class="mi">500</span>     <span class="mi">0</span>
</pre></div>
</div>
<p>其中，主要列的含义为：</p>
<ul class="simple">
<li><p>QUEUE_NAME：队列名</p></li>
<li><p>PRIO：优先级，数字越大优先级越高</p></li>
<li><p>STATUS：状态</p>
<ul>
<li><p>Open：队列开放，可以接受提交新作业</p></li>
<li><p>Active：队列已激活，队列中未开始运行的作业可以开始运行</p></li>
<li><p>Closed：队列已关闭，不接受提交新作业</p></li>
<li><p>Inact：队列未激活，可接受提交新作业，但队列中的等待运行的作业不会开始运行</p></li>
</ul>
</li>
<li><p>MAX：队列对应的最大作业槽数（Job
Slot，一般与CPU核数一致，以下通称CPU核数），-表示无限</p></li>
<li><p>JL/U：单个用户同时可以使用的CPU核数</p></li>
<li><p>JL/P：每个处理器可以接受的CPU核数</p></li>
<li><p>JL/H：每个节点可以接受的CPU核数</p></li>
<li><p>NJOBS：排队、运行和被挂起的总作业所占CPU核数</p></li>
<li><p>PEND：排队中的作业所需CPU核数</p></li>
<li><p>RUN：运行中的作业所占CPU核数</p></li>
<li><p>SUSP：被挂起的作业所占CPU核数</p></li>
<li><p>RSV：为排队作业预留的CPU核数</p></li>
</ul>
<section id="bqueues-l">
<h3 id="bqueues-l">查看队列详细情况：bqueues -l<a class="headerlink" href="#bqueues-l" title="此标题的永久链接">¶</a></h3>
<p>队列策略也许会调整，利用<code class="docutils literal notranslate"><span class="pre">bqueues</span> <span class="pre">-l</span> <span class="pre">[队列名]</span></code>查看各队列的详细情况：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QUEUE</span><span class="p">:</span> <span class="n">small</span>
 <span class="o">--</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">job</span> <span class="n">slots</span> <span class="n">that</span> <span class="n">each</span> <span class="n">user</span> <span class="n">can</span> <span class="n">use</span> <span class="ow">in</span> <span class="n">this</span> <span class="n">queue</span> <span class="ow">is</span> <span class="mf">720.</span>
 <span class="n">on</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">node1</span><span class="o">~</span><span class="n">node67</span>

<span class="n">PARAMETERS</span><span class="o">/</span><span class="n">STATISTICS</span>
<span class="n">PRIO</span> <span class="n">NICE</span> <span class="n">STATUS</span>          <span class="n">MAX</span> <span class="n">JL</span><span class="o">/</span><span class="n">U</span> <span class="n">JL</span><span class="o">/</span><span class="n">P</span> <span class="n">JL</span><span class="o">/</span><span class="n">H</span> <span class="n">NJOBS</span>  <span class="n">PEND</span>   <span class="n">RUN</span> <span class="n">SSUSP</span> <span class="n">USUSP</span>  <span class="n">RSV</span>
 <span class="mi">57</span>   <span class="mi">20</span>  <span class="n">Open</span><span class="p">:</span><span class="n">Active</span>     <span class="mi">720</span>  <span class="mi">120</span>    <span class="o">-</span>    <span class="o">-</span>  <span class="mi">1964</span>  <span class="mi">1464</span>   <span class="mi">500</span>     <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">0</span>
<span class="n">Interval</span> <span class="k">for</span> <span class="n">a</span> <span class="n">host</span> <span class="n">to</span> <span class="n">accept</span> <span class="n">two</span> <span class="n">jobs</span> <span class="ow">is</span> <span class="mi">0</span> <span class="n">seconds</span>

 <span class="n">PROCLIMIT</span>
 <span class="mi">48</span>

<span class="n">SCHEDULING</span> <span class="n">PARAMETERS</span>
           <span class="n">r15s</span>   <span class="n">r1m</span>  <span class="n">r15m</span>   <span class="n">ut</span>      <span class="n">pg</span>    <span class="n">io</span>   <span class="n">ls</span>    <span class="n">it</span>    <span class="n">tmp</span>    <span class="n">swp</span>    <span class="n">mem</span>
 <span class="n">loadSched</span>   <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>       <span class="o">-</span>     <span class="o">-</span>    <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>      <span class="o">-</span>      <span class="o">-</span>
 <span class="n">loadStop</span>    <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>       <span class="o">-</span>     <span class="o">-</span>    <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>      <span class="o">-</span>      <span class="o">-</span>

          <span class="n">adapter_windows</span>     <span class="n">poe</span> <span class="n">nrt_windows</span>
 <span class="n">loadSched</span>             <span class="o">-</span>       <span class="o">-</span>           <span class="o">-</span>
 <span class="n">loadStop</span>              <span class="o">-</span>       <span class="o">-</span>           <span class="o">-</span>

<span class="n">SCHEDULING</span> <span class="n">POLICIES</span><span class="p">:</span>  <span class="n">EXCLUSIVE</span>

<span class="n">USERS</span><span class="p">:</span> <span class="n">paiduigroup</span><span class="o">/</span> <span class="n">scc_group</span><span class="o">/</span>
<span class="n">HOSTS</span><span class="p">:</span>  <span class="n">node1</span> <span class="n">node2</span> <span class="n">node3</span> <span class="n">node4</span> <span class="n">node5</span> <span class="n">node6</span> <span class="n">node7</span> <span class="n">node8</span> <span class="n">node9</span> <span class="n">node10</span> <span class="n">node11</span> <span class="n">node12</span>
<span class="n">RES_REQ</span><span class="p">:</span>  <span class="n">span</span><span class="p">[</span><span class="n">ptile</span><span class="o">=</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>QUEUE：队列名，跟着的下一行是描述</p></li>
<li><p>PRIO：优先值，越大越优先</p></li>
<li><p>NICE：作业运行时的nice值，即作业运行时的操作系统调度优先值，从-20到19，越小越优先</p></li>
<li><p>RUNLIMIT：作业单CPU运行时间限制，以系统中的某个节点为基准，如为1440.0 min则表示可以运行一天（60*24）</p></li>
<li><p>CPULIMIT：单个作业运行时间限制，以系统中的某个节点E5410作为参考，运行机时（核数*墙上时间）为345600.0 CPU分钟，即如用8 CPU核计算，允许运行30天</p></li>
<li><p>PROCLIMIT：单个作业核数限制，<code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">4</span> <span class="pre">8</span></code>，表示使用此队列时，最少使用2个核，最多使用8核，如提交时没用-n指定具体核数，则使用默认4核</p></li>
<li><p>PROCESSLIMIT：单个作业最大核数限制，为8</p></li>
<li><p>MEMLIMIT：每个进程能使用的内存数，默认以KB为单位</p></li>
<li><p>THREADLIMIT：作业最大线程数</p></li>
<li><p>USERS：有权使用的用户</p></li>
<li><p>HOSTS：对应的节点</p></li>
</ul>
</section>
</section>
<section id="lsload">
<h2 id="lsload">查看各节点的运行情况：lsload<a class="headerlink" href="#lsload" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">lsload</span></code>命令可查看当前各节点的运行情况，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">lsload</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HOST_NAME</span>     <span class="n">status</span>  <span class="n">r15s</span>   <span class="n">r1m</span>  <span class="n">r15m</span>    <span class="n">ut</span>   <span class="n">pg</span>   <span class="n">ls</span>  <span class="n">it</span>   <span class="n">tmp</span>   <span class="n">swp</span>   <span class="n">mem</span>
<span class="n">node1</span>         <span class="n">ok</span>       <span class="mf">0.0</span>   <span class="mf">0.0</span>   <span class="mf">0.0</span>   <span class="mi">0</span><span class="o">%</span>   <span class="mf">0.5</span>   <span class="mi">0</span>   <span class="mi">25</span>  <span class="mi">227</span><span class="n">G</span>   <span class="mi">32</span><span class="n">G</span>   <span class="mi">62</span><span class="n">G</span>
<span class="n">node2</span>         <span class="n">locku</span>    <span class="mf">0.1</span>   <span class="mf">0.0</span>   <span class="mf">0.0</span>   <span class="mi">0</span><span class="o">%</span>   <span class="mf">0.4</span>   <span class="mi">0</span>   <span class="mi">60</span>  <span class="mi">227</span><span class="n">G</span>   <span class="mi">32</span><span class="n">G</span>   <span class="mi">62</span><span class="n">G</span>
<span class="n">node4</span>         <span class="n">unavail</span>   <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>    <span class="o">-</span>      <span class="o">-</span>   <span class="o">-</span>    <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>
</pre></div>
</div>
<ul class="simple">
<li><p>HOST_NAME：节点名。</p></li>
<li><p>status：状态。</p></li>
<li><p>status列：</p>
<ul>
<li><p>ok：表示可以接受新作业，只有这种状态可以接受新作业</p></li>
<li><p>closed：表示系统在运行，但已被调度系统关闭，不接受新作业</p></li>
<li><p>locku：表示在进行排他性运行</p></li>
<li><p>busy：表示负载超过限定</p></li>
<li><p>unavail、-ok：作业调度系统服务有问题</p></li>
</ul>
</li>
<li><p>r15s、r1m、r15m列：分别表示15秒、1分钟、15分钟平均负载</p></li>
<li><p>ut：利用率</p></li>
<li><p>tmp：目录大小</p></li>
<li><p>swp：swp虚拟内存大小</p></li>
<li><p>mem：内存大小</p></li>
<li><p>io：硬盘读写（-l选项时才出现）</p></li>
</ul>
<p>查看node2节点：<code class="docutils literal notranslate"><span class="pre">lsload</span> <span class="pre">node2</span></code></p>
</section>
<section id="bhosts">
<h2 id="bhosts">查看各节点的空闲情况：bhosts<a class="headerlink" href="#bhosts" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">bhosts</span></code>命令可查看当前各节点的空闲情况，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bhosts</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HOST_NAME</span>  <span class="n">STATUS</span>  <span class="n">JL</span><span class="o">/</span><span class="n">U</span>  <span class="n">MAX</span>  <span class="n">NJOBS</span>  <span class="n">RUN</span>  <span class="n">SSUSP</span>  <span class="n">USUSP</span>  <span class="n">RSV</span>
<span class="n">node12</span>         <span class="n">closed</span>   <span class="o">-</span>    <span class="mi">16</span>       <span class="mi">2</span>    <span class="mi">2</span>      <span class="mi">0</span>      <span class="mi">0</span>    <span class="mi">0</span>
<span class="n">node10</span>         <span class="n">ok</span>       <span class="o">-</span>    <span class="mi">16</span>       <span class="mi">2</span>    <span class="mi">1</span>      <span class="mi">0</span>      <span class="mi">0</span>    <span class="mi">0</span>
<span class="n">node14</span>         <span class="n">ok</span>       <span class="o">-</span>    <span class="mi">16</span>       <span class="mi">2</span>    <span class="mi">1</span>      <span class="mi">0</span>      <span class="mi">0</span>    <span class="mi">0</span>
</pre></div>
</div>
<ul class="simple">
<li><p>HOST_NAME：节点名。</p></li>
<li><p>STATUS：状态。</p>
<ul>
<li><p>ok：表示可以接收新作业，只有这种状态可以接受新作业</p></li>
<li><p>closed：表示已被作业占满，不接受新作业</p></li>
<li><p>unavail和unreach：系统停机或作业调度系统服务有问题</p></li>
</ul>
</li>
<li><p>JL/U：允许每个用户的作业核数。-表示未限制。</p></li>
<li><p>MAX：允许最大作业核数。</p></li>
<li><p>NJOBS：当前运行的作业数。</p></li>
<li><p>RUN：当前运行作业占据的核数。</p></li>
<li><p>SSUSP：被系统挂起的作业占据的核数。</p></li>
<li><p>USUSP：被用户挂起的作业占据的核数。</p></li>
<li><p>RSV：预留的核数。</p></li>
</ul>
<p>查看node1节点：<code class="docutils literal notranslate"><span class="pre">bhosts</span> <span class="pre">node1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">bhosts</span> <span class="pre">-l</span></code>会显示节点详细信息，其中slots表示目前最大可以接受作业槽数（默认一般与CPU核数一致）</p>
<p>即使有节点状态为ok状态，也不一定表示您的作业可以运行，具体运行条件参见<a class="reference external" href="#run">[run]</a>作业运行条件。</p>
</section>
<section id="busers">
<h2 id="busers">查看用户信息：busers<a class="headerlink" href="#busers" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">busers</span></code>可以查看用户信息，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">busers</span> <span class="pre">hmli</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">USER</span><span class="o">/</span><span class="n">GROUP</span> <span class="n">JL</span><span class="o">/</span><span class="n">P</span> <span class="n">MAX</span> <span class="n">NJOBS</span> <span class="n">PEND</span> <span class="n">RUN</span> <span class="n">SSUSP</span> <span class="n">USUSP</span> <span class="n">RSV</span>
<span class="n">hmli</span>           <span class="o">-</span>     <span class="mi">320</span>     <span class="mi">40</span>     <span class="mi">32</span>    <span class="mi">8</span>      <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">0</span>
</pre></div>
</div>
<p>其中：</p>
<ul class="simple">
<li><p>USER/GROUP：用户或组名。</p></li>
<li><p>JL/U：允许每个用户的作业核数。-表示未限制。</p></li>
<li><p>MAX：允许最大作业核数。</p></li>
<li><p>NJOBS：当前运行的作业数。</p></li>
<li><p>PEND：当前挂起作业占据的核数。</p></li>
<li><p>RUN：当前运行作业占据的核数。</p></li>
<li><p>SSUSP：被系统挂起的作业占据的核数。</p></li>
<li><p>USUSP：被用户挂起的作业占据的核数。</p></li>
<li><p>RSV：预留的核数。</p></li>
</ul>
</section>
<section id="bsub">
<h2 id="bsub">提交作业：bsub<a class="headerlink" href="#bsub" title="此标题的永久链接">¶</a></h2>
<p>用户需要利用<code class="docutils literal notranslate"><span class="pre">bsub</span></code>提交作业，其基本格式为<code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">[options]</span> <span class="pre">command</span> <span class="pre">[arguments]</span></code>。其中options设置队列、CPU核数等的选项，必须在command之前，否则将作为command的参数；arguments为设置作业的可执行程序本身所需要的参数，必须在command之后，否则将作为设置队列等的选项。下面将给出常用的几种提交方式。</p>
<p>注意：</p>
<ul class="simple">
<li><p>作业提交后，应经常检查一下作业的CPU、内存等利用率，判断实际运行效率：</p>
<ul>
<li><p>可以<code class="docutils literal notranslate"><span class="pre">ssh</span></code>到对应运行作业的节点运行<code class="docutils literal notranslate"><span class="pre">top</span></code>命令；</p></li>
<li><p>查看Ganglia系统监控：<a class="reference external" href="http://scc.ustc.edu.cn/ganglia">http://scc.ustc.edu.cn/ganglia</a>。</p></li>
</ul>
</li>
<li><p>请不要ssh到节点后直接运行作业，以免影响作业调度系统分配到此节点的作业。</p></li>
</ul>
<section id="bsub-q">
<h3 id="bsub-q">提交到特定队列：bsub -q<a class="headerlink" href="#bsub-q" title="此标题的永久链接">¶</a></h3>
<p>利用<code class="docutils literal notranslate"><span class="pre">-q</span></code>选项可以指定提交到哪个队列，，请注意参看登录后的提示或运行<code class="docutils literal notranslate"><span class="pre">bqueues</span> <span class="pre">-l</span></code>命令查看，现有的队列为：</p>
<ul class="simple">
<li><p>normal：所需要的CPU核数大于1个且不超过16个时</p></li>
<li><p>long：所需要的CPU核数超过32个时</p></li>
<li><p>serial：所需要的CPU核数为一个时</p></li>
</ul>
<p>比如想提交到normal队列使用2个CPU核运行程序executable1，可以：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-q</span> <span class="pre">normal</span> <span class="pre">-n</span> <span class="pre">2</span> <span class="pre">executable1</span></code></p>
<p>如果提交成功，将显示类似下面的输出：</p>
<p>Job &lt;79722&gt; is submitted to queue &lt;normal&gt;.</p>
<p>其中79722为此作业的作业号，以后可利用此作业号来进行查询及终止等操作。</p>
<p>如提交不成功，则显示相应提示。</p>
</section>
<section id="bsub-n-1">
<h3 id="bsub-n-1">提交串行作业：bsub -n 1<a class="headerlink" href="#bsub-n-1" title="此标题的永久链接">¶</a></h3>
<p>我校超算系统鼓励运行并行作业，允许运行的串行作业资源较少，有些系统不允许运行串行作业。</p>
<p>运行串行作业，请使用支持串行队列的队列（假如serial队列支持串行），比如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-q</span> <span class="pre">serial</span> <span class="pre">-n</span> <span class="pre">1</span> <span class="pre">executable-serial</span></code></p>
</section>
<section id="cpu-bsub-n">
<h3 id="cpu-bsub-n">指明所需要的CPU核数：bsub -n<a class="headerlink" href="#cpu-bsub-n" title="此标题的永久链接">¶</a></h3>
<p>利用<code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">min\_proc[,max\_proc]</span></code>选项指定所需要的CPU核数（一般来说核数和进程数一致），比如下面指定利用24个CPU核（由<code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">24</span></code>指定）运行MPI（由<code class="docutils literal notranslate"><span class="pre">mpijob</span></code>指明为运行MPI程序）程序：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-q</span> <span class="pre">small</span> <span class="pre">-n</span> <span class="pre">24</span> <span class="pre">mpijob</span> <span class="pre">executable-mpi1</span></code></p>
<p>最少采用24最大采用72 CPU核数运行：<code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-n</span> <span class="pre">24,72</span></code></p>
<p>当作业调度尝试开始运行时：</p>
<ul class="simple">
<li><p>如空闲资源满足72 CPU核，那么将采用72 CPU核运行；</p></li>
<li><p>如空闲资源不满足72 CPU核，但满足24 CPU核，则用24 CPU核运行。</p></li>
</ul>
<p>由于每个节点的CPU核数为24，建议单个作业所使用的核数最好为24或12的整数倍，以尽量保证自己的程序占据独立的节点或半个节点，尽量避免相互影响。以上仅仅是建议，具体申请核数应考虑作业实际情况。即使同一个计算软件，在计算不同条件时，也有可能不一样，请务必仔细研究自己所使用的软件。</p>
</section>
<section id="bsub-m-host-name">
<h3 id="bsub-m-host-name">提交到特定节点：bsub -m “host_name”<a class="headerlink" href="#bsub-m-host-name" title="此标题的永久链接">¶</a></h3>
<p>利用<code class="docutils literal notranslate"><span class="pre">-m</span></code>选项可以指定作业在特定节点上运行，如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-m</span> <span class="pre">``node1</span> <span class="pre">node3''</span></code></p>
<p>如非必要，建议不要添加此选项，以免导致作业无法及时运行。</p>
</section>
<section id="mpi-bsub-n-num-mpijob">
<h3 id="mpi-bsub-n-num-mpijob">提交MPI作业：bsub -n NUM mpijob<a class="headerlink" href="#mpi-bsub-n-num-mpijob" title="此标题的永久链接">¶</a></h3>
<p>如果需要运行MPI作业，需要利用<code class="docutils literal notranslate"><span class="pre">mpijob</span></code>调用MPI可执行程序，并用-n选项指定所需的CPU核数，比如下面指定利用64颗CPU核运行MPI程序executable-mpi1：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-q</span> <span class="pre">long</span> <span class="pre">-n</span> <span class="pre">64</span> <span class="pre">mpijob</span> <span class="pre">executable-mpi1</span></code></p>
<p>注意：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mpijob</span></code>命令已经封装了Intel MPI和Open
MPI的运行MPI作业的脚本，用户一般无需再特别按照Intel MPI和Open
MPI的原始<code class="docutils literal notranslate"><span class="pre">mpirun</span></code>、<code class="docutils literal notranslate"><span class="pre">mpiexec</span></code>等命令使用。</p></li>
<li><div class="line-block">
<div class="line">提交作业时在<code class="docutils literal notranslate"><span class="pre">mpijob</span></code>之前的参数将传递给LSF，之后的参数将传递给原始的<code class="docutils literal notranslate"><span class="pre">mpirun</span></code>或</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">mpiexec</span></code>等。</div>
</div>
</li>
<li><p>如用户对LSF和Intel MPI、Open
MPI等不熟悉，请勿擅自添加其它参数，如有需要请与超算中心联系。</p></li>
<li><p>如您了解所使用的MPI环境与LSF的配合，也可不用<code class="docutils literal notranslate"><span class="pre">mpijob</span></code>提交，如直接用<code class="docutils literal notranslate"><span class="pre">mpirun</span></code>等命令运行。</p></li>
</ul>
</section>
<section id="bsub-r">
<h3 id="bsub-r">指明需要某种资源作业提交：bsub -R<a class="headerlink" href="#bsub-r" title="此标题的永久链接">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">-R</span> <span class="pre">``res_req''</span> <span class="pre">[-R</span> <span class="pre">``res_req''</span> <span class="pre">...]</span></code>可以使得作业在需要满足某种条件的节点上运行，如：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">-R</span> <span class="pre">``span[hosts=1]''</span></code>：指定需要在同一个节点内运行；</p></li>
<li><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">-R</span> <span class="pre">``span[ptile=8]''</span></code>：指定需要在每一个节点内运行多少核，如<code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-n</span> <span class="pre">16</span> <span class="pre">-R</span> <span class="pre">``span[ptile=8]''</span></code></div>
<div class="line">则会分给2个节点，每个节点8核；</div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">-R</span> <span class="pre">``1*{mem&gt;5000}</span> <span class="pre">+</span> <span class="pre">9*{mem&gt;1000}''</span></code>：一个CPU核需要至少5GB内存，另外9个每个至少需要1GB内存。</p></li>
</ul>
</section>
<section id="openmp-bsub-r-span-hosts-1-omp-num-threads">
<h3 id="openmp-bsub-r-span-hosts-1-omp-num-threads">提交OpenMP等共享内存作业：bsub -R “span[hosts=1]” OMP_NUM_THREADS=<a class="headerlink" href="#openmp-bsub-r-span-hosts-1-omp-num-threads" title="此标题的永久链接">¶</a></h3>
<p>由于只能在同一个节点内部运行OpenMP共享内存的作业，如Gaussian程序，此时需要添加利用<code class="docutils literal notranslate"><span class="pre">-R</span> <span class="pre">``span[hosts=1]''</span></code>参数指定使用一个节点，并用OMP_NUM_THREADS设定指定的线程数，一般应与申请的核数一致 <a class="footnote-reference brackets" href="#id4" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>：</p>
<p>指定利用8 CPU核运行OpenMP程序：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-q</span> <span class="pre">normal</span> <span class="pre">-n</span> <span class="pre">8</span> <span class="pre">-R</span> <span class="pre">``span[hosts=1]''</span> <span class="pre">OMP_NUM_THREADS=8</span> <span class="pre">executable-omp1</span></code></p>
</section>
<section id="mpiopenmp">
<h3 id="mpiopenmp">MPI和OpenMP共享内存混合并行作业<a class="headerlink" href="#mpiopenmp" title="此标题的永久链接">¶</a></h3>
<p>需要针对需求利用LSF环境变量特殊处理，如果自己不清楚怎么处理，请联系管理人员。</p>
</section>
<section id="bsub-p-project-name">
<h3 id="bsub-p-project-name">给作业起个名字：bsub -P project_name<a class="headerlink" href="#bsub-p-project-name" title="此标题的永久链接">¶</a></h3>
<p>提交时可以利用<code class="docutils literal notranslate"><span class="pre">-P</span></code>选项给作业起个名字方便查看，如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-P</span> <span class="pre">VASPJOB</span></code></p>
</section>
<section id="bsub-x">
<h3 id="bsub-x">运行排他性作业：bsub -x<a class="headerlink" href="#bsub-x" title="此标题的永久链接">¶</a></h3>
<p>如需要独占节点运行，此时需要添加-x选项：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-x</span> <span class="pre">-q</span> <span class="pre">normal</span> <span class="pre">-n</span> <span class="pre">8</span> <span class="pre">executable-omp1</span></code></p>
<p>注意：</p>
<ul class="simple">
<li><p>排他性运行在运行期间，不允许其余的作业提交到运行此作业的节点，并且只有在某节点没有任何其余的作业在运行时才会提交到此节点上运行；</p></li>
<li><p>如果不需要采用排他性运行，请不要使用此选项，否则将导致作业必须等待完全空闲的节点才会运行，也许将增加等待时间；</p></li>
<li><p>另外使用排他性运行时，哪怕只使用某节点内的一个CPU核，也将按照此节点内的所有CPU核数进行机时计算。</p></li>
</ul>
</section>
<section id="bsub-i-o-e">
<h3 id="bsub-i-o-e">指明输出、输出文件运行：bsub -i -o -e<a class="headerlink" href="#bsub-i-o-e" title="此标题的永久链接">¶</a></h3>
<p>作业的正常屏幕输入文件（指的是类似
方式的文件）、正常屏幕输出到的文件和错误屏幕输出的文件可以利用-i、-o和-e选项来分别指定，运行后可以通过查看指定的这些输出文件来查看运行状态，文件名可利用%J与作业号挂钩。比如指定executable1的输入、正常和错误屏幕输出文件分别为：、和：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-i</span> <span class="pre">executable1.input</span> <span class="pre">-o</span> <span class="pre">executable1-\%J.log</span> <span class="pre">-e</span> <span class="pre">executable1-\%J.err</span> <span class="pre">executable1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">-o</span></code>和<code class="docutils literal notranslate"><span class="pre">-e</span></code>及变种<code class="docutils literal notranslate"><span class="pre">-oo</span></code>和<code class="docutils literal notranslate"><span class="pre">-eo</span></code>：</p>
<ul class="simple">
<li><p>-o：如日志原文件存在，正常屏幕输出将追加到原文件后</p></li>
<li><p>-oo：如日志原文件存在，正常屏幕输出将覆盖原文件</p></li>
<li><p>-e：如日志原文件存在，出错时屏幕输出将追加到原文件后</p></li>
<li><p>-eo：如日志原文件存在，出错时屏幕输出将覆盖原文件</p></li>
</ul>
<p>建议打开-o和-e参数，以便查看作业为什么出问题等。如果需要管理人员协助解决，请告知这些输出，以及运行目录，怎么运行的等，以便管理人员能获取足够的信息及时处理。</p>
</section>
<section id="bsub-outdir-output-directory">
<h3 id="bsub-outdir-output-directory">指明输出目录提交：bsub -outdir output_directory<a class="headerlink" href="#bsub-outdir-output-directory" title="此标题的永久链接">¶</a></h3>
<p>默认情况下，屏幕输出等存放在提交作业时的目录下，如想将其放到其它目录可以采用<code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-outdir</span> <span class="pre">output\_directory</span></code>方式，如：</p>
<p><cite>bsub -outdir %U/%J_%I myprog</cite></p>
<p>结合以下常用变量，可以方便结合作业号等设置输出目录及日志文件名等：</p>
<ul class="simple">
<li><p>%J：作业号</p></li>
<li><p>%JG：作业组</p></li>
<li><p>%I：作业组中的索引</p></li>
<li><p>%EJ：执行作业号</p></li>
<li><p>%EI：作业组中的执行作业索引</p></li>
<li><p>%P：作业名</p></li>
<li><p>%U：用户名</p></li>
<li><p>%G：用户组名</p></li>
</ul>
</section>
<section id="bsub-i">
<h3 id="bsub-i">交互式运行作业：bsub -I<a class="headerlink" href="#bsub-i" title="此标题的永久链接">¶</a></h3>
<p>如果需要运行交互式的作业（如在运行期间需要手动输入参数或利用调试器手动调试程序等需要进行交互时），需要结合-I参数。建议只是在调试期间使用，一般作业还是尽量不要使用此选项，类似选项还有-Ip和-Is：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-I</span> <span class="pre">executable1</span></code></p>
</section>
<section id="bsub-w">
<h3 id="bsub-w">满足依赖关系运行作业：bsub -w<a class="headerlink" href="#bsub-w" title="此标题的永久链接">¶</a></h3>
<p>利用<code class="docutils literal notranslate"><span class="pre">-w</span></code>选项可以使得新提交的作业在满足一定条件时才运行，比如与其它作业的关联：</p>
<ul class="simple">
<li><p>done(job_ID |“job_name” …)：作业结束时状态为DONE时运行</p></li>
<li><p>ended(job_ID | “job_name”)：作业结束时状态为DONE或EXIT时运行</p></li>
<li><p>exit(job_ID | “job_name” [,[operator]
exit_code])：作业结束时状态为EXIT，且退出代码满足一定条件时运行</p></li>
<li><p>external(job_ID | “job_name”,
“status_text”)：作业状态变为某状态时运行，如变为SUSP</p></li>
<li><p>支持的条件之间的条件表达式：&amp;&amp;（和）、||（或）、!（否）</p></li>
<li><p>支持的条件内的条件算子：&gt;、 &gt;=、 &lt;、 &lt;=、==、!=</p></li>
</ul>
<p>如：<code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-w</span> <span class="pre">``done(1456)''</span></code></p>
</section>
<section id="bsub-b-time">
<h3 id="bsub-b-time">指定时间运行：bsub -b time<a class="headerlink" href="#bsub-b-time" title="此标题的永久链接">¶</a></h3>
<p>利用<code class="docutils literal notranslate"><span class="pre">-b</span> <span class="pre">[[year:][month:]day:]hour:minute</span></code>可以使得新提交的作业在特定时间运行，系统会预留资源给此作业，如果在时间到达时所需资源满足则会运行，不满足则继续等待。如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-b</span> <span class="pre">2016:01:09:09:20</span></code></p>
</section>
<section id="bsub-w-time">
<h3 id="bsub-w-time">指定运行时长：bsub -W time<a class="headerlink" href="#bsub-w-time" title="此标题的永久链接">¶</a></h3>
<p>利用<code class="docutils literal notranslate"><span class="pre">-W</span> <span class="pre">[hour:]minute</span></code>可以使得提交的作业在运行超过设定时长后终止，如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-W</span> <span class="pre">1:30</span></code></p>
</section>
<section id="bsub-e-pre-command">
<h3 id="bsub-e-pre-command">在运行前执行特定命令：bsub -E “pre_command”<a class="headerlink" href="#bsub-e-pre-command" title="此标题的永久链接">¶</a></h3>
<p>利用<code class="docutils literal notranslate"><span class="pre">-E</span> <span class="pre">``pre_exec_command</span> <span class="pre">[arguments</span> <span class="pre">...]''</span></code>可以使得作业在运行前，在所分配的节点上运行特定命令。</p>
<p>如利用modinput.sh此修改程序输入参数：<code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-E</span> <span class="pre">`</span></code>./modinput.sh 10’’ -n 2 exec1`</p>
</section>
<section id="bsub-ep-post-command">
<h3 id="bsub-ep-post-command">在运行后执行特定命令：bsub -Ep “post_command”<a class="headerlink" href="#bsub-ep-post-command" title="此标题的永久链接">¶</a></h3>
<p>利用<code class="docutils literal notranslate"><span class="pre">-Ep</span> <span class="pre">``post_exec_command</span> <span class="pre">[arguments</span> <span class="pre">...]''</span></code>可以使得作业在运行结束时，在所分配的节点上运行特定命令。</p>
<p>如利用此删除core文件：<code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">-Ep</span> <span class="pre">``bin/rm</span> <span class="pre">-f</span> <span class="pre">core.*''</span> <span class="pre">-n</span> <span class="pre">2</span> <span class="pre">exec1</span></code></p>
</section>
<section id="id3">
<h3 id="id3">LSF作业脚本<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h3>
<p>如果作业比较复杂，还需要设置环境变量，做其它处理等，可用以在LSF脚本中设置队列等参数方式提交，如</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="c1">#BSUB -q long</span>
<span class="c1">#BSUB -o %J.log -e %J.err</span>
<span class="c1">#BSUB -n 64</span>
<span class="nb">source</span><span class="w"> </span>my.sh
mpijob<span class="w"> </span>./mympi-prog1
<span class="nb">cd</span><span class="w"> </span>newworkdir
mpijob<span class="w"> </span>./mympi-prog2
</pre></div>
</div>
<p>注意，采用此方式时：</p>
<ul class="simple">
<li><p>不得以直接<code class="docutils literal notranslate"><span class="pre">./my_script.lsf</span></code>等常规脚本运行方式运行。</p></li>
<li><p>需要传递给<code class="docutils literal notranslate"><span class="pre">bsub</span></code>命令运行：<code class="docutils literal notranslate"><span class="pre">bsub</span> <span class="pre">&lt;</span> <span class="pre">my_script.lsf</span></code>。</p></li>
<li><p>如果bsub后面更-q等LSF参数，将会覆盖掉LSF脚本中的设置。</p></li>
<li><p>一般用户，没必要写此类脚本，直接通过命令行传递LSF参数即可。</p></li>
<li><p>对于当前设置满足不了作业需求，且用户比较了解LSF中的各规定，对shell脚本编写比较在行，那么用户完全可自己编写脚本提交作业，比如提交特殊需求的MPI与OpenMP结合的作业。</p></li>
</ul>
<p>LSF作业脚本主要有以下常见变量比较常用，在作业运行后，这些变量存储对应的作业信息，具体的请参看LSF官方手册：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LS_JOBPID</span></code>：作业进程号</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LSB_HOSTS</span></code>：存储系统分配的节点名</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LSB_JOBFILENAME</span></code>：作业脚本文件名</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LSB_JOBID</span></code>：作业号</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LSB_QUEUE</span></code>：作业队列</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LSB_JOBPGIDS</span></code>：作业进程组号组</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LSB_JOBPIDS</span></code>：作业进程号组</p></li>
</ul>
</section>
</section>
<section id="bkill">
<h2 id="bkill">终止作业：bkill<a class="headerlink" href="#bkill" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">bkill</span></code>命令可以终止某个运行中或者排队中的作业，比如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bkill</span> <span class="pre">79722</span></code></p>
<p>运行成功后，将显示类似下面的输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Job</span> <span class="o">&lt;</span><span class="mi">79722</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">terminated</span>
</pre></div>
</div>
</section>
<section id="bstop">
<h2 id="bstop">挂起作业：bstop<a class="headerlink" href="#bstop" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">bstop</span></code>命令可临时挂起某个作业以让别的作业先运行，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bstop</span> <span class="pre">79727</span></code></p>
<p>运行成功后，将显示类似下面的输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Job</span> <span class="o">&lt;</span><span class="mi">79727</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">stopped</span><span class="o">.</span>
</pre></div>
</div>
<p>此命令可以将排在队列前面的作业临时挂起，以让后面的作业先运行。虽然也可以作用于运行中的作业，但并不会因为此作业被挂起而允许其余作业占用此作业所占用的CPU运行，实际资源不会释放，因此建议不要随便对运行中的作业进行挂起操作，如果运行中的作业不再想继续运行，请用<code class="docutils literal notranslate"><span class="pre">bkill</span></code>终止。</p>
</section>
<section id="bresume">
<h2 id="bresume">继续运行被挂起的作业：bresume<a class="headerlink" href="#bresume" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">bresume</span></code>命令可继续运行某个挂起某个作业，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bresume</span> <span class="pre">79727</span></code></p>
<p>运行成功后，将显示类似下面的输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Job</span> <span class="o">&lt;</span><span class="mi">79727</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">resumed</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="btop">
<h2 id="btop">设置作业最先运行：btop<a class="headerlink" href="#btop" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">btop</span></code>命令可最先运行排队中的某个作业，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">btop</span> <span class="pre">79727</span></code></p>
<p>运行成功后，将显示类似下面的输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Job</span> <span class="o">&lt;</span><span class="mi">79727</span><span class="o">&gt;</span> <span class="n">has</span> <span class="n">been</span> <span class="n">moved</span> <span class="n">to</span> <span class="n">position</span> <span class="mi">1</span> <span class="kn">from</span> <span class="nn">top.</span>
</pre></div>
</div>
</section>
<section id="bbot">
<h2 id="bbot">设置作业最后运行：bbot<a class="headerlink" href="#bbot" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">bbot</span></code>命令可设定最后运行排队中的某个作业，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bbot</span> <span class="pre">79727</span></code></p>
<p>运行成功后，将显示类似下面的输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Job</span> <span class="o">&lt;</span><span class="mi">79727</span><span class="o">&gt;</span> <span class="n">has</span> <span class="n">been</span> <span class="n">moved</span> <span class="n">to</span> <span class="n">position</span> <span class="mi">1</span> <span class="kn">from</span> <span class="nn">bottom.</span>
</pre></div>
</div>
</section>
<section id="bmod">
<h2 id="bmod">修改排队中的作业选项：bmod<a class="headerlink" href="#bmod" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">bmod</span></code>命令可修改排队中的某个作业的选项，比如想将排队中的运行作业号为79727的作业的执行命令修改为executable2并且换到long队列，可以：</p>
<p><code class="docutils literal notranslate"><span class="pre">bmod</span> <span class="pre">-Z</span> <span class="pre">executable2</span> <span class="pre">-q</span> <span class="pre">long</span> <span class="pre">79727</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Parameters</span> <span class="n">of</span> <span class="n">job</span> <span class="o">&lt;</span><span class="mi">79727</span><span class="o">&gt;</span> <span class="n">are</span> <span class="n">being</span> <span class="n">changed</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="bjobs">
<h2 id="bjobs">查看作业的排队和运行情况：bjobs<a class="headerlink" href="#bjobs" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">bjobs</span></code>可以查看作业的运行情况，比如有哪些作业在运行，哪些在排队，某个作业运行在哪个节点上，以及为什么没有运行等，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bjobs</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JOBID</span> <span class="n">USER</span>  <span class="n">STAT</span>  <span class="n">QUEUE</span>    <span class="n">FROM_HOST</span>   <span class="n">EXEC_HOST</span> <span class="n">JOB_NAME</span>   <span class="n">SUBMIT_TIME</span>
<span class="mi">79726</span> <span class="n">hmli</span>  <span class="n">RUN</span>   <span class="n">normal</span>   <span class="n">tc4600</span>      <span class="mi">2</span><span class="o">*</span><span class="n">node31</span>  <span class="o">*</span><span class="n">executab1</span> <span class="n">Mar</span> <span class="mi">12</span> <span class="mi">19</span><span class="p">:</span><span class="mi">20</span>
                                       <span class="mi">1</span><span class="o">*</span><span class="n">node18</span>
                                       <span class="mi">1</span><span class="o">*</span><span class="n">node4</span>
<span class="mi">79727</span> <span class="n">hmli</span>  <span class="n">PEND</span>  <span class="n">long</span>     <span class="n">tc4600</span>                <span class="o">*</span><span class="n">executab2</span> <span class="n">Mar</span> <span class="mi">12</span> <span class="mi">19</span><span class="p">:</span><span class="mi">20</span>
</pre></div>
</div>
<p>上面显示作业79726在运行，分别在node31、node18和node4上运行2、1、1个进程；而作业79727处于排队中尚未运行，查看未运行的原因可以利用：</p>
<p><code class="docutils literal notranslate"><span class="pre">bjobs</span> <span class="pre">-l</span> <span class="pre">79727</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Job Id &lt;79727&gt;, tc4600 &lt;hmli&gt;, Project &lt;default&gt;, Status &lt;PEND&gt;,
Queue &lt;long&gt; , Command &lt;executab2&gt;
Sun Mar 12 14:15:07: Submitted from host &lt;tc4600&gt;,
CWD &lt;$HOME&gt;, Requested Resources &lt;type==any &amp;&amp; swp&gt;35&gt;;
PENDING REASONS:
SCHEDULING PARAMETERS:
            r15s r1m r15m  ut pg   io  ls   it   tmp   swp   mem
loadSched   -    0.7 1.0   - 4.0   -   -    -    -     -     -
loadStop    -    1.5 2.5   - 8.0   -   -    -    -     -     -
</pre></div>
</div>
<p>以下为另外几个常用参数：</p>
<ul class="simple">
<li><p>-u
username：查看某用户的作业，如username为all，则查看所有用户的作业。</p></li>
<li><p>-q queuename：查看某队列上的作业。</p></li>
<li><p>-m hostname：查看某节点上的作业。</p></li>
</ul>
</section>
<section id="checkjob">
<h2 id="checkjob">查看作业负载：checkjob<a class="headerlink" href="#checkjob" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">/opt/bin/monitor/checkjob</span> <span class="pre">作业号</span></code>可以查看作业各节点负载等信息，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">/opt/bin/monitor/checkjob</span> <span class="pre">799374</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span><span class="p">:</span> <span class="n">hmli</span><span class="p">,</span> <span class="n">jobid</span><span class="p">:</span> <span class="mi">799374</span>
<span class="n">Note</span><span class="p">:</span> <span class="n">cpu_load</span> <span class="n">near</span> <span class="n">cpu_num</span> <span class="ow">and</span> <span class="n">swap_used</span> <span class="n">smaller</span> <span class="ow">or</span> <span class="n">zero</span> <span class="ow">is</span> <span class="n">better</span><span class="o">.</span>
<span class="n">node_name</span>  <span class="n">cpu_num</span>  <span class="n">cpu_load</span>  <span class="n">memory</span><span class="p">(</span><span class="o">%</span><span class="p">)</span>  <span class="n">swap_used</span><span class="p">(</span><span class="n">GB</span><span class="p">)</span>
<span class="n">node491</span>     <span class="mi">144</span>      <span class="mf">109.03</span>    <span class="mf">23.00</span>          <span class="mi">0</span>
<span class="n">node493</span>     <span class="mi">144</span>      <span class="mf">115.52</span>    <span class="mf">23.00</span>          <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="bpeek">
<h2 id="bpeek">查看运行中作业的屏幕正常输出：bpeek<a class="headerlink" href="#bpeek" title="此标题的永久链接">¶</a></h2>
<p>利用<code class="docutils literal notranslate"><span class="pre">bpeek</span></code>命令可查看运行中作业的屏幕正常输出，例如：</p>
<p><code class="docutils literal notranslate"><span class="pre">bpeek</span> <span class="pre">79727</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;&lt;</span> <span class="n">output</span> <span class="kn">from</span> <span class="nn">stdout</span> <span class="o">&gt;&gt;</span>
<span class="n">Energy</span><span class="p">:</span> <span class="mf">3.0</span><span class="n">keV</span>
<span class="n">Angles</span><span class="p">:</span> <span class="mf">13.0</span><span class="p">,</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>如果在运行中用-o和-e分别指定了正常和错误屏幕输出，也可以通过直接查看指定的文件的内容来查看屏幕输出。</p>
<p>如果想连续查看某个作业的输出，请添加-f参数。</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span><a href="#id2" role="doc-backlink">1</a><span class="fn-bracket">]</span></span>
<p>有些程序可以在输入文件中设置，那么可以不填加OMP_NUM_THREADS</p>
</aside>
</aside>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../slurm/slurm.html" title="简介"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> 简介 </span>
              </div>
            </a>
          
          
            <a href="../latex.html" title="LaTeX pdf版"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> LaTeX pdf版 </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2021, 中国科大超级计算中心.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>